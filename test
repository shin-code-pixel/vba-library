Option Explicit

Public Sub VBL_RunValidate_Sample()
    Dim defs(0 To 3) As T_VBL_FieldDef

    ' A1：顧客ID（数値 6桁 必須 0～999999）
    defs(0).SheetName = "Sheet1"
    defs(0).Address = "A1"
    defs(0).Label = "顧客ID"
    defs(0).Kind = eVBL_FieldKind_Number
    defs(0).Required = True
    defs(0).MaxDigits = 6
    defs(0).MinValue = 0
    defs(0).MaxValue = 999999

    ' B1：氏名（文字列 必須 禁止文字＋環境依存）
    defs(1).SheetName = "Sheet1"
    defs(1).Address = "B1"
    defs(1).Label = "氏名"
    defs(1).Kind = eVBL_FieldKind_Text
    defs(1).Required = True
    defs(1).CheckForbiddenChars = True
    defs(1).CheckEnvDependentChars = True

    ' C1：コード（半角英数字 必須 全角→半角に正規化）
    defs(2).SheetName = "Sheet1"
    defs(2).Address = "C1"
    defs(2).Label = "申請コード"
    defs(2).Kind = eVBL_FieldKind_HalfWidthAlphaNum
    defs(2).Required = True
    defs(2).NormalizeToHalfWidth = True

    ' D1：申請日（日付 必須 土日祝NG）
    defs(3).SheetName = "Sheet1"
    defs(3).Address = "D1"
    defs(3).Label = "申請日"
    defs(3).Kind = eVBL_FieldKind_Date
    defs(3).Required = True
    defs(3).RejectWeekend = True
    defs(3).UseHolidays = True

    ' 祝日（例：必要に応じて差し替え）
    Dim holidays
    holidays = Array(DateSerial(2026, 1, 1), DateSerial(2026, 2, 11))

    Dim errs As String
    errs = VBL_ValidateByDefs(defs, holidays)

    If Len(errs) > 0 Then
        MsgBox "入力エラーがあります：" & vbCrLf & vbCrLf & errs, vbExclamation
    Else
        MsgBox "OK（エラーなし）", vbInformation
    End If
End Sub
